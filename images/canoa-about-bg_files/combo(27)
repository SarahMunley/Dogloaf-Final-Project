YUI.add("fluid-photostream-coverphoto-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.namespace("Views")["fluid-coverphoto-view"],[],{langBundles:this.details.langBundles,subviewConfig:{"flickr-chat-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return!this.appContext.flipper.isFlipped("flickr-chat")||!this.appContext.getViewer().signedIn}},"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,isFluid:!0,isOnDark:!0}},initializer:function(t){return this.nsid=t.nsid,this.contextId=t.contextId||t.nsid,this.signinPendingQueue=e.SigninHelper.checkPendingQueue(this.appContext),this.constructor.superclass.initializer.call(this,t)},loadState:function(){var t=this,r=[];return r.push(this.appContext.getModel("person-models",this.get("pageNsid"))),r.push(this.appContext.getModel("person-contacts-count-models",this.get("pageNsid"))),r.push(this.appContext.getModel("person-profile-models",this.get("pageNsid"))),r.push(this.appContext.getModel("photostream-models",this.contextId)),r.push(this.appContext.getModel("person-relationship-models",this.get("pageNsid"))),r.push(this.getViewer()),e.Promise.all(r).then(function(e){var n=t.get("models");n.person=e[0],n.personContacts=e[1],n.personProfile=e[2],n.photostream=e[3],n.relationship=e[4],n.personViewer=e[5]||e[0],t.set("models",n),t.set("canEditCoverPhoto",t.get("viewingSelf")),t.set("coverPhotoId",n.photostream.getValue("id")),t.set("canShare",!0)},function(t){n.warn("Photostream cover error",{err:t})})},buildContainer:function(){var t={};return t=e.merge(t,this.buildPersonCoverPhoto(),this.buildAvatar(),this.buildTitleBlock(),this.buildMetadata()),this.get("viewingSelf")&&(t.canEdit={buddyiconURL:"/iconbuilder/"}),this.set("hideOptOutBanner",!0),this.constructor.superclass.buildContainer.call(this,t)},activate:function(){var e=this;return this.nsid&&this.signinPendingQueue&&this.signinPendingQueue.length>0&&this.signinPendingQueue.some(function(t){if(t.key==="follow"&&t.value.id===e.nsid&&e.subviews["follow-view"])return e.subviews["follow-view"].followPerson(e.nsid),!0}),this.get("models")&&this.get("models").photostream&&this.registerEventHandler(this.get("models").photostream.registry.on(null,"modelsRemoved",this.handleDataChanged.bind(this))),this.get("models")&&this.get("models").personProfile&&this.registerEventHandler(this.get("models").personProfile.on("valuesChanged",this.handleLocationChanged.bind(this))),this.constructor.superclass.activate.call(this)},handleLocationChanged:function(e){if(e&&e.location){var t=this.get("container").one(".metadata-content .cp-location"),n=this.get("container").one(".metadata-content");t?t.setHTML(e.location.newVal):n.prepend('<p class="truncate cp-location">'+e.location.newVal+"</p>")}},handleDataChanged:function(e){var t=this;e&&e[this.appContext.getViewer().nsid]&&this.loadState().then(function(){t.get("models")&&t.get("models").photostream&&(t.get("container").one(".metadata-content .photo-count").getDOMNode().innerHTML=t.intlMessage({intlName:"header.COUNT_PHOTOS",count:t.get("models").photostream.getValue("totalItems")}))})},buildTitleBlock:function(){var t=this.get("models"),n=t&&this.get("models").person,r=n&&e.URLHelper.generatePersonUrls(n),i={};return i.subtitle="",i.follow=this.subviews["follow-view"]?this.subviews["follow-view"].get("container"):"",n&&(i.title=n.getValue("displayname"),n.getValue("displayname")===n.getValue("realname")&&(i.subtitle=n.getValue("username")),!t.relationship.getValue("isIgnoredBy")&&!this.get("viewingSelf")&&r.sendFlickrMail&&(i.sendFlickrMailUrl=r.sendFlickrMail),this.appContext.flipper.isFlipped("enable-pro-badge")&&n.getValue("isPro")&&(i.isPro=!0)),{titleBlock:i}},buildAvatar:function(){var t=this.get("models"),n=t&&t.person,r=n&&n.getValue("buddyicon"),i=n&&e.URLHelper.generatePersonUrls(n);return n?{avatar:{canEdit:this.get("viewingSelf"),editUrl:"/iconbuilder/",linkUrl:i?i.photostream:null,icon:{retina:r?r.retina||r.large||r.medium:null,lowres:r?r.default:null},type:"person"}}:null},buildMetadata:function(){var t=this.get("models"),n=t&&t.photostream,r=t&&t.personContacts,i=t&&t.person,s=t&&t.personProfile,o=n?n.getValue("totalItems"):null,u=i?i.getValue("dateCreated"):null,a=i?e.URLHelper.generatePersonUrls(i):{},f=r?r.getValue("followerCount"):0,l=r?r.getValue("followingCount"):0;return{metadata:[{count:o,photos:!!o},{location:s?s.getValue("location"):null,hasLocation:s?!!s.getValue("location"):!1},{date:u?u.year():null,memberSince:!!u},{followerCount:f,followingCount:l,followerString:e.flutil.formatIntlPluralNumber(this.intlMessage({intlName:"header.FOLLOWERS",count:f}),f),followingString:e.flutil.formatIntlPluralNumber(this.intlMessage({intlName:"header.FOLLOWING",count:l}),l,!0),contacts:!!r,viewingSelf:this.get("viewingSelf"),followingUrl:a.list,followerUrl:a.revlist}]}}})},"@VERSION@",{requires:["flickr-view","fluid-coverphoto-view","follow-view","flutil"],langBundles:["header","common"]});
YUI.add("fluid-share-album-view",function(e,t){var n=require("lib/flog")(t);e.namespace("Views").FluidShareAlbumView=e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.albumId=e.albumId,this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-album-icon",sharingDisabled:!0,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_ALBUM"})}),this.constructor.superclass.initializer.call(this,e)},loadState:function(){return e.Promise.resolve()},getItemCount:function(){return this.loadRequiredModels()},loadRequiredModels:function(){var t=this,r=1;return e.Promise.all([this.appContext.getModel("set-models",this.albumId+"-"+r,{filter:r,perPage:5,page:1}),this.appContext.getModel("album-privacy-models",this.albumId),this.appContext.getModel("set-models",this.albumId)]).then(function(e){t.set("albumModel",e[0]),t.set("privacyModel",e[1]),t.isDisabled=e[0].getValue("canShare")===0,t.set("photos",e[0].getValue("photoPageList").getList()),t.set("fullAlbum",e[2]),e[2].on("valuesChanged",function(e){var n={};e&&(Object.keys(e).forEach(function(r){var i=e[r];i.id===t.albumId&&(n[r]=i.newVal)}),Object.keys(n).length>0&&t.get("albumModel").setValues(n))})},function(e){n.error("failed to get models",{err:e})})},buildContainer:function(){return this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-album-icon",sharingDisabled:this.isDisabled,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_ALBUM"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("albumModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("fullAlbum");return{url:e.URLHelper.getShortAlbumURL(t.getValue("normalizedId")),title:t.getValue("title")}},prepareTumblrShareParameters:function(){var e=this.get("fullAlbum");return{title:e.getValue("title"),authorURL:e.getValue("owner").getValue("url"),ownerName:e.getValue("owner").getValue("displayname"),description:e.getValue("description"),displayPhotoURL:this.get("photos").map(function(e){return e.getLargestSize().url}),url:e.getValue("url"),tags:"Flickr"}},preparePinterestShareParameters:function(){var t=this.get("fullAlbum");return{title:t.getValue("title"),description:t.getValue("description"),displayPhotoURL:this.get("photos").length>0?this.get("photos")[0].getLargestSize().url:null,shortURL:e.URLHelper.getShortAlbumURL(t.getValue("normalizedId")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("fullAlbum");return{modelName:"set",modelId:this.albumId,modelOwnerId:e.getValue("owner").id,title:e.getValue("title"),url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t=this.get("albumModel"),n=this.get("fullAlbum"),r,i,s,o=!1;r=this.intlMessage({intlName:"share-modal.ALBUM_PRIVACY_WARNING",photoCount:n.getValue("totalCount")});if(this.appContext.flipper.isFlipped("enable-album-download")&&n.getValue("owner").getValue("isMe")){o=!0;switch(this.appContext.getViewer().prefs.downloadAccessPref){case 4:s="ALBUM_DOWNLOAD_ACCESS_YOU";break;case 3:s="ALBUM_DOWNLOAD_ACCESS_FF";break;case 2:s="ALBUM_DOWNLOAD_ACCESS_FOLLOWING";break;case 1:s="ALBUM_DOWNLOAD_ACCESS_MEMBERS";break;case 0:s="ALBUM_DOWNLOAD_ACCESS_EVERYONE"}s&&(i=this.intlMessage({intlName:"share-modal."+s,photoCount:n.getValue("totalCount")}))}return{sizes:t.getValue("primaryPhotoSizes"),url:n.getValue("url"),title:n.getValue("title"),author:n.getValue("owner").getValue("displayname"),authorURL:n.getValue("owner").getValue("url"),albumId:t.getValue("normalizedId"),shortURL:e.URLHelper.getShortAlbumURL(n.getValue("normalizedId")||n.getValue("id")),supportsEmbedr:n.getValue("canShare")===2&&this.appContext.flipper.isFlipped("enable-embedr-in-share")&&this.appContext.flipper.isFlipped("enable-embedr-in-albums"),supportsBBCode:!1,privacyWarningString:r,showDownloadWarning:o,downloadAccessString:i}},getTitleIntlKey:function(){return"SHARE_ALBUM_TO"},getGuestPassParams:function(){var e=this.get("privacyModel"),t=this.get("fullAlbum").getValue("owner").getValue("isMe"),n=e.getValue("countPhotosPublic"),r=e.getValue("countPhotosFriendFamily"),i=e.getValue("countPhotosFriend"),s=e.getValue("countPhotosFamily"),o=this.get("privacyModel").getValue("totalCount")-n,u=t&&r>0&&r!==n,a=t&&i>0&&i!==n,f=t&&s>0&&s!==n,l=!1;u&&i===r&&(a=!1),u&&s===r&&(f=!1);if(o>0||u||f||a)l=!0;return{type:"set",id:this.get("albumModel").getValue("normalizedId"),contentMarkedFriends:a,contentMarkedFamily:f,contentMarkedFriendFamily:u,contentMarkedPublic:n,canSharePrivate:l&&t,showGuestPassDropdown:t&&n!==this.get("fullAlbum").getValue("totalCount"),multipleItems:!0}},getIsMine:function(){return this.get("albumModel").getValue("isOwner")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper"],langBundles:[]});
YUI.add("hermes-template-album-list-toolbar",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'		<a class="create-album" href="/photos/organize/?start_tab=new_set"><i></i><span>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"album-page.NEW_ALBUM"},data:i}))+'</span></a>\n		<div class="divider"></div>\n		<a class="create-collection" href="/photos/organize/?start_tab=sets"><i></i><span>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"album-page.NEW_COLLECTION"},data:i}))+'</span></a>\n		<a class="view-collections" href="'+a(e.lambda((s=t!=null?t.urls:t)!=null?s.collections:s,t))+'"><span>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"album-page.VIEW_MY_COLLECTIONS"},data:i}))+"</span></a>\n"},3:function(e,t,n,r,i){var s,o=e.escapeExpression;return'		<a class="view-collections" href="'+o(e.lambda((s=t!=null?t.urls:t)!=null?s.collections:s,t))+'"><span>'+o((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"album-page.VIEW_COLLECTIONS"},data:i}))+"</span></a>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return'<div class="album-toolbar-content">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isViewingSelf:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+"</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-list-toolbar",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-list-toolbar-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{},initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.nsid=e.nsid,this},loadState:function(){return this.appContext.getModel("person-models",this.nsid).then(function(e){this.set("person",e),this.set("isViewingSelf",this.nsid===this.appContext.getViewer().nsid)}.bind(this),function(e){})},buildContainer:function(){var t=this.get("person")&&e.URLHelper.generatePersonUrls(this.get("person"));return this.setContainerWithTemplate("album-list-toolbar",{urls:t,isViewingSelf:this.get("isViewingSelf")}),this},buildErrorContainer:function(){},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","url-helper","hermes-template-album-list-toolbar"],optional:[],langBundles:["album-page","common"]});
YUI.add("photolist-aft-helper",function(e){"use strict";var t=function(e){e=e.getDOMNode();var t=e.getBoundingClientRect();return t.top>=window.pageYOffset&&t.left>=window.pageXOffset};e.PhotolistAftHelper=function(e,t){var n=e.onSubviewEvent;this.appContext=e.appContext,this.viewName=e.name,this.container=e.get("container"),t&&(this.hasRequiredSubviews=!0,this.paftResults={},t.forEach(function(e){this.paftResults[e]={}}.bind(this))),YUI.Env.isServer||this.appContext.clientMetrics.setPendingMeasurement(e.name,!0),e.onSubviewEvent=function(t,r){(r&&r[0]==="atfVisible"||r[0]==="atfActivated")&&this.aftHelper.handleAFTResult(t,r),n&&n.call(e,t,r)}},e.PhotolistAftHelper.prototype.handleAFTResult=function(e,n){var r=n[0];if(this.hasRequiredSubviews){if(n.length>2&&this.container){var i=this.container.one("."+n[2]);if(i&&!t(i)){delete this.paftResults[n[2]],this.beaconIfAllAFTResultsComplete(r);return}}e=n[2]}this.paftResults||(this.paftResults={},this.hasRequiredSubviews||(this.paftResults[e]={})),this.paftResults[e][r]=n[1]||(new Date).getTime(),this.beaconIfAllAFTResultsComplete(r)},e.PhotolistAftHelper.prototype.beaconIfAllAFTResultsComplete=function(t){var n=0,r;if(this.allResultsReceived)return;this.allResultsReceived=Object.keys(this.paftResults).every(function(e){return r=this.paftResults[e][t],typeof r=="undefined"?!1:(r>n&&(n=r),!0)}.bind(this)),this.allResultsReceived&&t==="atfVisible"&&(this.appContext.hasClientSideRouted()?(this.appContext.clientMetrics.mark("AFT_CL",n),this.appContext.clientMetrics.mark("AFT",n)):(e.config.win.performance&&e.config.win.performance.timing&&(n-=e.config.win.performance.timing.navigationStart),this.appContext.clientMetrics.record("AFT_SV",n),this.appContext.clientMetrics.record("AFT",n)),this.appContext.clientMetrics.setPendingMeasurement(this.viewName,!1),this.appContext.clientMetrics.beacon())}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom"]});
YUI.add("albums-list-page-view",function(e,t){var n=require("lib/flog")(t);e.namespace("Views")[this.name]=e.Base.create("albums-list-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.nsid=t.nsid,this.isOwner=t.isOwner,this.withSetId=t.withSetId,this.pageParams=t.pageParams,t.modelRegistryName="sets-models",t.isViewingSelf=this.appContext.getViewer().signedIn?this.nsid===this.appContext.getViewer().nsid:!1,t.photoListConfig={modelParams:{registryName:"sets-models",modelIdOrAttributes:t.nsid,collectionAttributeName:"albumsList"},interactionViewName:"photo-list-album-interaction-view",engagementModelName:"set-models",viewBeaconRestrictedAttribute:"primaryNeedsInterstitial",parentName:this.name,pageParams:t.pageParams,viewBeaconAttribute:"primary",measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:t.withSetId},t.photoListConfig.layout={targetRowHeight:240,forceAspectRatio:1,containerPadding:{top:8,right:0,bottom:8,left:0},itemSpacing:{horizontal:32,vertical:32}},this.isMobile&&(t.photoListConfig.layout.targetRowHeight=200,t.photoListConfig.layout.containerPadding.right=16,t.photoListConfig.layout.containerPadding.left=16,t.photoListConfig.layout.itemSpacing.horizontal=16,t.photoListConfig.layout.itemSpacing.vertical=16),t.subnavConfig={selected:"albums"},this.aftHelper=new e.PhotolistAftHelper(this),this.doOffline=!!this.appContext.flipper.isFlipped("enable-offline-downloadr"),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"fluid-photostream-coverphoto-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-list-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["fluid-centered"]},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"signup-footer-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("sets-models",this.nsid).then(function(t){e.set("albumsListModel",t),e.set("totalItems",t.getValue("totalItems"))})},buildContainer:function(){var e=this.get("totalItems"),t,n;return n=this.pageParams.page>1||e>Math.abs((this.pageParams.viewPageSize||20)*(this.pageParams.page||1)),t=e>0,this.setContainerWithTemplate("albums-list-page",{"fluid-header":this.subviews["fluid-photostream-coverphoto-view"]?this.subviews["fluid-photostream-coverphoto-view"].get("container"):"","album-list-toolbar-view":t?this.subviews["album-list-toolbar-view"].get("container"):"",showPagination:n,isEmpty:this.get("totalItems").length===0,isViewingSelf:this.nsid===this.appContext.getViewer().nsid}),this},buildHeadContainer:function(){var e="";e+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1"}),e+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),e+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",e):(this.set("headContainer",this.subviews["pagination-view"].get("headContainer")),this.updateHead())},showErrorModal:function(t){var n;n=new e.Views.FluidModal({appContext:this.appContext,darkOverlay:!0,dismissOnOverlayClick:!0,showCancelButton:!1,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),title:this.intlMessage({intlName:"common.UPLOAD_ERROR_TITLE"}),message:t}),n.show()},createBook:function(t){var n=this;return this.showBalls(),e.rapidTracker.beacon(this.name,"createBook"),this.appContext.getModelRegistry("book-models").then(function(e){return e.remoteCreate({photoset_id:t}).then(function(e){n.hideBalls(),n.appContext.flapp.navigate("/create/books/"+e.id+"/cover")})}).catch(function(e){n.hideBalls(),n.showErrorModal("There was a problem creating the book. Please try again later")})},showBalls:function(){this.balls||(this.balls=e.Node.create('<div class="loading-balls"></div>'),this.balls.setHTML(this.templates("flickr-balls")({}))),this.get("container").append(this.balls)},hideBalls:function(){this.balls.remove()},downloadAlbum:function(t){var n=this,r,i,s=!!this.appContext.flipper.isFlipped("enable-offline-downloadr"),o;e.rapidTracker.beacon(this.name,"openDownloadAlbum"),o=this.get("albumsListModel").getOwnedModels().find(function(e){return e.id===t}),o&&this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===o.getValue("owner").id&&this.bulkDownloaderView.set("isOwnAlbum",!0),s?(i=n.bulkDownloaderView.createTitle(o.getValue("photoCount"),o.getValue("videoCount")),n.bulkDownloaderView.showDownloadDialog({doOffline:!0,title:i,setID:t})):(r=this.bulkDownloaderView.showLoadingDialog(),this.bulkDownloaderView.prepareArchive({set_id:t}).then(function(e){r.close(),n.bulkDownloaderView.showDownloadDialog(e)}).catch(function(e){r.close(),n.bulkDownloaderView.onError(e)}))},shareAlbum:function(t,n){var r=new e.Views.FluidShareAlbumView({appContext:this.appContext,albumId:t});this.showBalls(),e.rapidTracker.beacon(this.name,"openShareAlbum"),r.on("sharePresentationClose",r.destroy.bind(r)),r.initialize().then(function(){this.prepareModal(n)}.bind(r)).then(function(){this.hideBalls()}.bind(this)).catch(function(e){this.hideBalls()}.bind(this))},deleteAlbum:function(t){var r=this;return e.rapidTracker.beacon(this.name,"deleteAlbum"),this.showBalls(),this.confirmAlbumDelete(t).then(function(){return r.appContext.getModel("set-models",t).then(function(n){var i=[];return n.toJSON().photoPageList.forEach(function(e){i.push(r.appContext.getModel("photo-sets-models",e.id).then(function(e){e.getValue("sets").removeFromList(t)}))}),i.push(n.registry.remoteDelete(t).then(function(){r.get("albumsListModel").getValue("albumsList").remove(t),r.appContext.flapp.navigate(e.config
.doc.location.href)})),e.Promise.all(i)})}).catch(function(e){n.error("Error deleting album",{err:e}),r.hideBalls()})},confirmAlbumDelete:function(t){var n=this;return e.rapidTracker.beacon(this.name,"deleteConfirm"),new e.Promise(function(t,r){var i=new e.Views.FluidModal({appContext:n.appContext,title:n.intlMessage({intlName:"common.CONFIRMATION"}),message:n.intlMessage({intlName:"album-page.CONFIRM_ALBUM_DELETE_NO_CONTENTS_DELETED"})});n.registerEventHandler(i.on("actionClick",function(){t()})),n.registerEventHandler(i.on("cancelClick",function(){e.rapidTracker.beacon(n.name,"cancelDeleteConfirm"),r()})),i.show()})},handleClick:function(e){var t=e.target,n,r;t.hasClass("cta")&&(e.halt(),n=t.ancestor(".photo-list-album-interaction"),r=n.getData("albumId"),t.hasClass("is-disabled")||(t.hasClass("share")?this.shareAlbum(r,t):t.hasClass("book")?this.createBook(r):t.hasClass("download")?this.downloadAlbum(r):t.hasClass("trash")&&this.deleteAlbum(r)))},destructor:function(){this.balls&&this.balls.inDoc()&&this.balls.remove(),this.balls=null,this.bulkDownloaderView&&this.bulkDownloaderView.destroy()},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick,this)),this.bulkDownloaderView=new e.BulkDownloaderView({appContext:this.appContext,doOffline:this.doOffline}),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handlePageResize.bind(this))),this},handlePageResize:function(){var t=e.config.win.innerWidth;t<=700?this.hasBeenMobilized||(this.hasBeenMobilized=!0,this.subviews["photo-list-view"].photoListLayout.targetRowHeight=200,this.subviews["photo-list-view"].photoListLayout.containerPadding.right=16,this.subviews["photo-list-view"].photoListLayout.containerPadding.left=16,this.subviews["photo-list-view"].photoListLayout.itemSpacing.horizontal=16,this.subviews["photo-list-view"].photoListLayout.itemSpacing.vertical=16):(this.hasBeenMobilized&&(this.subviews["photo-list-view"].photoListLayout.targetRowHeight=240,this.subviews["photo-list-view"].photoListLayout.containerPadding.right=0,this.subviews["photo-list-view"].photoListLayout.containerPadding.left=0,this.subviews["photo-list-view"].photoListLayout.itemSpacing.horizontal=32,this.subviews["photo-list-view"].photoListLayout.itemSpacing.vertical=32),this.hasBeenMobilized=!1)},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600578}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","hermes-template-albums-list-page","global-nav-view","footer-full-view","pagination-view","fluid-photostream-coverphoto-view","fluid-share-album-view","hermes-template-flickr-balls","album-list-toolbar-view","hermes-template-head-link","photolist-aft-helper","hermes-template-head-meta"],optionalRequires:["bulk-downloader-view"],optional:["sets-models","book-models"],langBundles:["album-page","common","magic-empty-states","meta"]});
YUI.add("hermes-lang-magic-empty-states",function(e,t){e.Intl.add("hermes/magic-empty-states","en-US",{PHOTOSTREAM_EMPTY:["You have no public photos"],PHOTOSTREAM_EMPTY_OTHER:["This user has no public photos"],PHOTOSTREAM_EMPTY_ACTION:["Upload photos"],ALBUM_EMPTY:["You have no albums"],ALBUM_EMPTY_OTHER:["This user has no albums"],ALBUM_EMPTY_ACTION:["Create an album"],FAVORITES_EMPTY:["You have no favorites"],FAVORITES_EMPTY_OTHER:["This user has no favorites"],FAVORITES_EMPTY_ACTION:["Explore photos"],SHARED_ENTITY_EMPTY_OTHER:["Nothing shared"],CREATIONS_NO_WALLARTS:["Wall art and photo books. Created by you."],CREATIONS_NO_BOOKS:["Wall art and photo books. Created by you."],STATS_HEADLINE:["Introducing all new stats for Pro"],STATS_HEADLINE_1:["When it comes to stats. Know it all."],STATS_HEADLINE_2:["Everything you need to know. Statistically speaking."],STATS_HEADLINE_3:["Details. Details. Details."],STATS_HEADLINE_4:["The kind of minutia you\u2019ll like."],STATS_SUB_HEADLINE:["Gain an understanding of how people are discovering your Flickr photos. See which of your photos are trending now and which have performed the best over the life of your Flickr account."],STATS_SUB_HEADLINE_1:["Want to know how people are finding your photos on Flickr? Curious to  see which of your photos are trending now and which have performed the best over the life of your account? Get all the details and more."],FAVES_HEADLINE_YOU:["Start picking your faves. Just click on the star."],FAVES_SUBHEADLINE_YOU:["Like something you see? Let the photographer know by clicking on the star icon."],FAVES_HEADLINE_OTHERS:["${username}"," doesn't have any favorites yet. Stay tuned."],START_EXPLORING_FLICKR:["Start exploring Flickr"],CAMERAROLL_HEADLINE:["Got a lot of photos? We've got a lot of space."],CAMERAROLL_SUBHEADLINE:["Every flickr member gets 1,000 GB of photo storage for FREE. Every photo is safely stored and can be accessed from your computer, smart phone or tablet at any time &dash; from anywhere."],CAMERAROLL_SUBHEADLINE_MAGIC:["Your Magic View is empty because we have not found any relevant categories for your photos so far. Try uploading more photos with different subjects."],PHOTOSTREAM_HEADLINE_YOU:["Don't forget to upload your photos."],PHOTOSTREAM_SUBHEADLINE_YOU:["Your photostream is your public-facing portfolio. Upload photos and set them to public using the Camera Roll to populate your photostream."],START_UPLOADING:["Start uploading"],PHOTOSTREAM_HEADLINE_YOU_PUBLIC:["You have no public photos."],PHOTOSTREAM_SUBHEADLINE_YOU_PUBLIC:["Your photostream is your public-facing portfolio. Set your photos to public using the Camera Roll to populate your photostream."],PHOTOSTREAM_HEADLINE_YOU_FRIENDS:["You have no public photos."],PHOTOSTREAM_SUBHEADLINE_YOU_FRIENDS:["Your photostream is your public-facing portfolio. Set your photos to public using the Camera Roll to populate your photostream."],PHOTOSTREAM_HEADLINE_YOU_FAMILY:["You have no public photos."],PHOTOSTREAM_SUBHEADLINE_YOU_FAMILY:["Your photostream is your public-facing portfolio. Set your photos to public using the Camera Roll to populate your photostream."],PHOTOSTREAM_HEADLINE_YOU_FRIENDSFAMILY:["You have no public photos."],PHOTOSTREAM_SUBHEADLINE_YOU_FRIENDSFAMILY:["Your photostream is your public-facing portfolio. Set your photos to public using the Camera Roll to populate your photostream."],PHOTOSTREAM_HEADLINE_OTHERS:["${username}"," hasn't made any photos public yet."],ALBUMS_HEADLINE_YOU:["Let's make an album."],ALBUMS_SUBHEADLINE_YOU:["Easily organize all your photos into beautiful albums to share with friends, family, or even other Flickr members."],GO_TO_CAMERA_ROLL:["Go to Camera Roll"],ALBUMS_HEADLINE_OTHERS:["As soon as ","${username}"," puts the camera down, we may have an album to view."],ALBUMS_SLOW:["We're having some trouble displaying this album at the moment. Please try again."],PHOTOSTREAM_SLOW:["We're having some trouble displaying this photostream at the moment. Please try again."],FAVES_SLOW:["We're having some trouble displaying these favorites at the moment. Please try again."],CAMERAROLL_SLOW:["We're having some trouble displaying your cameraroll at the moment. Please try again."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-meta",function(e,t){e.Intl.add("hermes/meta","en-US",{PHOTOSTREAM:["Explore ","${username}","'s ",{type:"plural",valueName:"photoCount",options:{one:"photo on Flickr!",other:"${#} photos on Flickr!"}}],PHOTOSTREAM_NO_PHOTOS:["Explore ","${username}","'s photos on Flickr!"],ALBUMS_LIST:["Explore ","${username}","'s ",{type:"plural",valueName:"photoCount",options:{one:"album on Flickr!",other:"${#} albums on Flickr!"}}],ALBUMS_LIST_NO_ALBUMS:["Explore ","${username}","'s albums on Flickr!"],FAVORITES:["Explore ","${username}","'s ",{type:"plural",valueName:"photoCount",options:{one:"favorites on Flickr!",other:"${#} favorites on Flickr!"}}],FAVORITES_NO_PHOTOS:["Explore ","${username}","'s favorites on Flickr!"],META_DESCRIPTION_BY_USER_ON_FLICKR:["By ","${username}"," on Flickr"],PHOTOSTREAM_ATOM_TITLE:["Flickr: ","${username}","'s Photostream Atom feed"],FAVORITES_ATOM_TITLE:["Flickr: ","${username}","'s Favorites Atom feed"],GROUP_POOL_ATOM_TITLE:["Flickr: ","${groupName}","'s Photos Atom feed"],GROUP_DISCUSSIONS_ATOM_TITLE:["Flickr: ","${groupName}","'s Discussions Atom feed"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-downloadr",function(e,t){e.Intl.add("hermes/downloadr","en-US",{DOWNLOAD_WHEN_READY:["We'll zip up these items and send you a FlickrMail with a link to download them when they are ready."],BE_SURE_RIGHTS:["Also, be sure you have the rights to these items before you download them."],CREATE_ZIP:["Create zip file"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-bulk-download-modal",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"	<p>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"downloadr.DOWNLOAD_WHEN_READY"},data:i}))+'</p>\n\n	<p class="copyright">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"downloadr.BE_SURE_RIGHTS"},data:i}))+"</p>\n\n"},3:function(e,t,n,r,i){var s,o=t!=null?t:{};return"\n"+((s=n.unless.call(o,t!=null?t.isOwnAlbum:t,{name:"unless",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.isMany:t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.isMany:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(11,i,0),data:i}))!=null?s:"")},4:function(e,t,n,r,i){return"		<p>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"album-page.DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2"},data:i}))+"</p>\n"},6:function(e,t,n,r,i){return"		<p>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"album-page.ALOT_OF_PHOTOS"},data:i}))+"</p>\n"},8:function(e,t,n,r,i){var s;return"		<ul>\n"+((s=n.each.call(t!=null?t:{},t!=null?t.downloadURLs:t,{name:"each",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:"")+"		</ul>\n"},9:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"				<li>\n					<span>\n						"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{partSequence:t!=null?t.partSequence:t,intlName:"album-page.DOWNLOAD_ZIP_PART"},data:i}))+'\n					</span>\n					<a class="butt mini" href="'+a((s=(s=n.url||(t!=null?t.url:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"url",hash:{},data:i}):s))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.DOWNLOAD"},data:i}))+"</a>\n				</li>\n"},11:function(e,t,n,r,i){var s,o,u=e.escapeExpression;return'		<a class="butt mini" href="'+u(e.lambda((s=(s=t!=null?t.downloadURLs:t)!=null?s["0"]:s)!=null?s.url:s,t))+'">'+u((o=(o=n.buttonLabel||(t!=null?t.buttonLabel:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(t!=null?t:{},{name:"buttonLabel",hash:{},data:i}):o))+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.doOffline:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/bulk-download-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("bulk-downloader-view",function(e,t){"use strict";e.BulkDownloaderView=e.Base.create("BulkDownloaderView",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.localizeLib=e.mix({langBundles:["common","album-page","cameraroll"],appContext:this.appContext},e.Localizable),this.set("isOwnAlbum",t.isOwnAlbum),this.doOffline=!!t.doOffline},showLoadingDialog:function(){var t=(new e.Views.FluidModal({appContext:this.appContext,showCancelButton:!1,showFooter:!1,showActionButton:!1,title:this.intlMessage({intlName:"cameraroll.PREPARING_DOWNLOAD"}),message:this.templates("flickr-balls")({}),classList:"bulk-download-loading-dialog"})).show();return t},createTitle:function(e,t){var n="";e=e||0,t=t||0;if(e>0&&t>0)n=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS_AND_VIDEO",photoCount:e,videoCount:t});else if(e>0&&t===0)n=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e});else{if(!(e===0&&t>0))throw new Error(this.intlMessage({intlName:"cameraroll.DOWNLOAD_NOT_AVAILABLE_ERROR"}));n=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})}return n},createButtonLabel:function(e,t){var n="";return t+e>1?n=this.intlMessage({intlName:"album-page.DOWNLOAD_ZIP"}):e===1&&t===0?n=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e}):e===0&&t===1&&(n=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})),n},prepareArchive:function(e){var t=this;return this.appContext.callAPI("flickr.download.archives.create",e).then(function(e){var n=e.archive.countPhotos,r=e.archive.countVideos,i=[],s,o;return s=t.createTitle(n,r),o=t.createButtonLabel(n,r),i=e.archive.urls.map(function(e,t){return{url:e,partSequence:t+1}}),{title:s,downloadURLs:i,buttonLabel:o}}).catch(function(e){throw e.code===105?new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})):new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"}))})},showDownloadDialog:function(n){var r=n.title,i=this,s=n.downloadURLs||[],o,u;return this.doOffline&&(n.setID?o={set_id:n.setID}:o={photo_ids:n.photoIDs,owner_id:n.ownerID}),u=(new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!this.doOffline,showCancelButton:this.doOffline,showFooter:this.doOffline,showActionButton:this.doOffline,actionButtonLabel:this.doOffline?this.intlMessage({intlName:"downloadr.CREATE_ZIP"}):"",title:r,message:this.templates("bulk-download-modal")({isMany:s.length>1,downloadURLs:s,buttonLabel:n.buttonLabel,isOwnAlbum:this.get("isOwnAlbum"),doOffline:this.doOffline}),classList:"bulk-download-dialog"})).show(),i.doOffline?(u.on("actionClick",function(n){n.preventDefault(),e.rapidTracker.beacon(t,"completeArchiveDownloadClick"),u.get("container").one(".copyright").setHTML(i.templates("flickr-balls")({})),i.prepareArchive(o).then(function(){u.close()}).catch(function(e){e.code===105?i.onError(new Error(i.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"}))):i.onError(new Error(i.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"})))})}),u.on("cancelClick",function(n){n.preventDefault(),e.rapidTracker.beacon(t,"archiveCancelClick"),u.close()})):u.on("activated",function(){u.get("container").all(".butt").on("click",function(n){s.length===1?(e.rapidTracker.beacon(t,"completeArchiveDownloadClick"),u.close()):(e.rapidTracker.beacon(t,"partialArchiveDownloadClick"),n.target.addClass("is-disabled"))})}),u},onError:function(t){var n=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.ERROR"}),message:t.message,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),showCancelButton:!1});n.show()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","hermes-template-bulk-download-modal","hermes-template-flickr-balls"],langBundles:["common","downloadr","album-page","cameraroll"],optional:[],affinity:"client"});
